var sortable=function(){"use strict";function l(e,t,n){if(void 0===n)return e&&e.h5s&&e.h5s.data&&e.h5s.data[t];e.h5s=e.h5s||{},e.h5s.data=e.h5s.data||{},e.h5s.data[t]=n}var g=function(e,t){if(!(e instanceof NodeList||e instanceof HTMLCollection||e instanceof Array))throw new Error("You must provide a nodeList/HTMLCollection/Array of elements to be filtered.");return"string"!=typeof t?Array.from(e):Array.from(e).filter(function(e){return 1===e.nodeType&&e.matches(t)})},h=new Map,t=(Object.defineProperty(e.prototype,"config",{get:function(){var n={};return this._config.forEach(function(e,t){n[t]=e}),n},set:function(e){if("object"!=typeof e)throw new Error("You must provide a valid configuration object to the config setter.");e=Object.assign({},e);this._config=new Map(Object.entries(e))},enumerable:!1,configurable:!0}),e.prototype.setConfig=function(e,t){if(!this._config.has(e))throw new Error("Trying to set invalid configuration item: "+e);this._config.set(e,t)},e.prototype.getConfig=function(e){if(!this._config.has(e))throw new Error("Invalid configuration item requested: "+e);return this._config.get(e)},Object.defineProperty(e.prototype,"placeholder",{get:function(){return this._placeholder},set:function(e){if(!(e instanceof HTMLElement)&&null!==e)throw new Error("A placeholder must be an html element or null.");this._placeholder=e},enumerable:!1,configurable:!0}),e.prototype.setData=function(e,t){if("string"!=typeof e)throw new Error("The key must be a string.");this._data.set(e,t)},e.prototype.getData=function(e){if("string"!=typeof e)throw new Error("The key must be a string.");return this._data.get(e)},e.prototype.deleteData=function(e){if("string"!=typeof e)throw new Error("The key must be a string.");return this._data.delete(e)},e);function e(){this._config=new Map,this._placeholder=void 0,this._data=new Map}var v=function(e){if(!(e instanceof HTMLElement))throw new Error("Please provide a sortable to the store function.");return h.has(e)||h.set(e,new t),h.get(e)};function a(e,t,n){if(e instanceof Array)for(var r=0;r<e.length;++r)a(e[r],t,n);else e.addEventListener(t,n),v(e).setData("event"+t,n)}function o(e,t){if(e instanceof Array)for(var n=0;n<e.length;++n)o(e[n],t);else e.removeEventListener(t,v(e).getData("event"+t)),v(e).deleteData("event"+t)}function s(e,t,n){if(e instanceof Array)for(var r=0;r<e.length;++r)s(e[r],t,n);else e.setAttribute(t,n)}function r(e,t){if(e instanceof Array)for(var n=0;n<e.length;++n)r(e[n],t);else e.removeAttribute(t)}function n(e,t,n){if(!(e instanceof HTMLElement&&e.parentElement instanceof HTMLElement))throw new Error("target and element must be a node");e.parentElement.insertBefore(t,"before"===n?e:e.nextElementSibling)}function i(e,t){if(!(e instanceof Array))throw new Error("You must provide a Array of HTMLElements to be filtered.");return"string"!=typeof t?e:e.filter(function(e){return e.querySelector(t)instanceof HTMLElement||e.shadowRoot&&e.shadowRoot.querySelector(t)instanceof HTMLElement}).map(function(e){return e.querySelector(t)||e.shadowRoot&&e.shadowRoot.querySelector(t)})}function c(e,t,n){return{element:e,posX:n.pageX-t.left,posY:n.pageY-t.top}}var y=function(e){if(!e.parentElement||0===e.getClientRects().length)throw new Error("target element must be part of the dom");e=e.getClientRects()[0];return{left:e.left+window.pageXOffset,right:e.right+window.pageXOffset,top:e.top+window.pageYOffset,bottom:e.bottom+window.pageYOffset}},d=function(n,r){var o;return void 0===r&&(r=0),function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];clearTimeout(o),o=setTimeout(function(){n.apply(void 0,e)},r)}},E=function(e,t){if(!(e instanceof HTMLElement&&(t instanceof NodeList||t instanceof HTMLCollection||t instanceof Array)))throw new Error("You must provide an element and a list of elements.");return Array.from(t).indexOf(e)},f=function(e){if(!(e instanceof HTMLElement))throw new Error("Element is not a node element.");return null!==e.parentNode},w=function(e,t){return n(e,t,"before")},b=function(e,t){return n(e,t,"after")},u=function(t,n,e){if(void 0===n&&(n=function(e,t){return e}),void 0===e&&(e=function(e){return e}),!(t instanceof HTMLElement)||!0==!t.isSortable)throw new Error("You need to provide a sortableContainer to be serialized.");if("function"!=typeof n||"function"!=typeof e)throw new Error("You need to provide a valid serializer for items and the container.");var r=l(t,"opts").items,o=g(t.children,r),r=o.map(function(e){return{parent:t,node:e,html:e.outerHTML,index:E(e,o)}});return{container:e({node:t,itemCount:r.length}),items:r.map(function(e){return n(e,t)})}},p=function(e,t,n){if(void 0===n&&(n="sortable-placeholder"),!(e instanceof HTMLElement))throw new Error("You must provide a valid element as a sortable.");if(!(t instanceof HTMLElement)&&void 0!==t)throw new Error("You must provide a valid element as a placeholder or set ot to undefined.");return void 0===t&&(["UL","OL"].includes(e.tagName)?t=document.createElement("li"):["TABLE","TBODY"].includes(e.tagName)?(t=document.createElement("tr")).innerHTML='<td colspan="100"></td>':t=document.createElement("div")),"string"==typeof n&&(e=t.classList).add.apply(e,n.split(" ")),t},T=function(e){if(!(e instanceof HTMLElement))throw new Error("You must provide a valid dom element");var t=window.getComputedStyle(e);return"border-box"===t.getPropertyValue("box-sizing")?parseInt(t.getPropertyValue("height"),10):["height","padding-top","padding-bottom"].map(function(e){e=parseInt(t.getPropertyValue(e),10);return isNaN(e)?0:e}).reduce(function(e,t){return e+t})},C=function(e){if(!(e instanceof HTMLElement))throw new Error("You must provide a valid dom element");var t=window.getComputedStyle(e);return["width","padding-left","padding-right"].map(function(e){e=parseInt(t.getPropertyValue(e),10);return isNaN(e)?0:e}).reduce(function(e,t){return e+t})},L=function(e){return e.composedPath&&e.composedPath()[0]||e.target},x=function(e,t,n){if(!(e instanceof Event))throw new Error("setDragImage requires a DragEvent as the first argument.");if(!(t instanceof HTMLElement))throw new Error("setDragImage requires the dragged element as the second argument.");if(n=n||c,e.dataTransfer&&e.dataTransfer.setDragImage){t=n(t,y(t),e);if(!(t.element instanceof HTMLElement)||"number"!=typeof t.posX||"number"!=typeof t.posY)throw new Error("The customDragImage function you provided must return and object with the properties element[string], posX[integer], posY[integer].");e.dataTransfer.effectAllowed="copyMove",e.dataTransfer.setData("text/plain",L(e).id),e.dataTransfer.setDragImage(t.element,t.posX,t.posY)}},M=function(e,t){if(!0===e.isSortable){var n=v(e).getConfig("acceptFrom");if(null!==n&&!1!==n&&"string"!=typeof n)throw new Error('HTML5Sortable: Wrong argument, "acceptFrom" must be "null", "false", or a valid selector string.');if(null!==n)return!1!==n&&0<n.split(",").filter(function(e){return 0<e.length&&t.matches(e)}).length;if(e===t)return!0;if(void 0!==v(e).getConfig("connectWith")&&null!==v(e).getConfig("connectWith"))return v(e).getConfig("connectWith")===v(t).getConfig("connectWith")}return!1},D={items:null,connectWith:null,disableIEFix:null,acceptFrom:null,copy:!1,placeholder:null,placeholderClass:"sortable-placeholder",draggingClass:"sortable-dragging",hoverClass:!1,dropTargetContainerClass:!1,debounce:0,throttleTime:100,maxItems:0,itemSerializer:void 0,containerSerializer:void 0,customDragImage:null,orientation:"vertical"};function m(e,t){var r;"string"==typeof v(e).getConfig("hoverClass")&&(r=v(e).getConfig("hoverClass").split(" "),!0===t?(a(e,"mousemove",function(r,o){var a=this;if(void 0===o&&(o=250),"function"!=typeof r)throw new Error("You must provide a function as the first argument for throttle.");if("number"!=typeof o)throw new Error("You must provide a number as the second argument for throttle.");var i=null;return function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=Date.now();(null===i||o<=n-i)&&(i=n,r.apply(a,e))}}(function(n){0===n.buttons&&g(e.children,v(e).getConfig("items")).forEach(function(e){var t;e!==n.target?(t=e.classList).remove.apply(t,r):(e=e.classList).add.apply(e,r)})},v(e).getConfig("throttleTime"))),a(e,"mouseleave",function(){g(e.children,v(e).getConfig("items")).forEach(function(e){(e=e.classList).remove.apply(e,r)})})):(o(e,"mousemove"),o(e,"mouseleave")))}function H(e){o(e,"dragstart"),o(e,"dragend"),o(e,"dragover"),o(e,"dragenter"),o(e,"drop"),o(e,"mouseenter"),o(e,"mouseleave")}function I(e,t){e&&o(e,"dragleave"),t&&t!==e&&o(t,"dragleave")}function A(e){var t;(t=e).h5s&&delete t.h5s.data,r(e,"aria-dropeffect")}function S(e){r(e,"aria-grabbed"),r(e,"aria-copied"),r(e,"draggable"),r(e,"role")}var Y,_,O,P,z,N,W,j,F,q=function(e,t){var n=e;return!0===v(t).getConfig("copy")&&(s(n=e.cloneNode(!0),"aria-copied","true"),e.parentElement.appendChild(n),n.style.display="none",n.oldDisplay=e.style.display),n};function R(e,t){if(t.composedPath)return t.composedPath().find(function(e){return e.isSortable});for(;!0!==e.isSortable;)e=e.parentElement;return e}function X(e,t){var n=l(e,"opts"),n=g(e.children,n.items).filter(function(e){return e.contains(t)||e.shadowRoot&&e.shadowRoot.contains(t)});return 0<n.length?n[0]:t}var B=function(e){var t=l(e,"opts"),n=g(e.children,t.items),r=i(n,t.handle);s(e,"aria-dropeffect","move"),l(e,"_disabled","false"),s(r,"draggable","true"),m(e,!0),!1===t.disableIEFix&&"function"==typeof(document||window.document).createElement("span").dragDrop&&a(r,"mousedown",function(){if(-1!==n.indexOf(this))this.dragDrop();else{for(var e=this.parentElement;-1===n.indexOf(e);)e=e.parentElement;e.dragDrop()}})},k=function(e){var t=l(e,"opts"),n=g(e.children,t.items),t=i(n,t.handle);l(e,"_disabled","false"),H(n),I(P,j),o(t,"mousedown"),o(e,"dragover"),o(e,"dragenter"),o(e,"drop")};function U(e,m){var n=String(m);return m=m||{},(e="string"==typeof e?document.querySelectorAll(e):e)instanceof HTMLElement&&(e=[e]),e=Array.prototype.slice.call(e),/serialize/.test(n)?e.map(function(e){var t=l(e,"opts");return u(e,t.itemSerializer,t.containerSerializer)}):(e.forEach(function(i){if(/enable|disable|destroy/.test(n))return U[n](i);["connectWith","disableIEFix"].forEach(function(e){Object.prototype.hasOwnProperty.call(m,e)&&null!==m[e]&&console.warn('HTML5Sortable: You are using the deprecated configuration "'+e+'". This will be removed in an upcoming version, make sure to migrate to the new options when updating.')}),m=Object.assign({},D,v(i).config,m),v(i).config=m,l(i,"opts",m),i.isSortable=!0,k(i);var e=g(i.children,m.items);null!==m.placeholder&&void 0!==m.placeholder&&(t=document.createElement(i.tagName),m.placeholder instanceof HTMLElement?t.appendChild(m.placeholder):t.innerHTML=m.placeholder,t=t.children[0]),v(i).placeholder=p(i,t,m.placeholderClass),l(i,"items",m.items),m.acceptFrom?l(i,"acceptFrom",m.acceptFrom):m.connectWith&&l(i,"connectWith",m.connectWith),B(i),s(e,"role","option"),s(e,"aria-grabbed","false"),a(i,"dragstart",function(e){var t,n,r=L(e);!0!==r.isSortable&&(e.stopImmediatePropagation(),m.handle&&!r.matches(m.handle)||"false"===r.getAttribute("draggable")||(n=X(t=R(r,e),r),W=g(t.children,m.items),z=W.indexOf(n),N=E(n,t.children),P=t,x(e,n,m.customDragImage),_=T(n),O=C(n),n.classList.add(m.draggingClass),s(Y=q(n,t),"aria-grabbed","true"),t.dispatchEvent(new CustomEvent("sortstart",{detail:{origin:{elementIndex:N,index:z,container:P},item:Y,originalTarget:r}}))))}),a(i,"dragenter",function(e){var n=L(e),r=R(n,e);r&&r!==j&&(F=g(r.children,l(r,"items")).filter(function(e){return e!==v(i).placeholder}),m.dropTargetContainerClass&&r.classList.add(m.dropTargetContainerClass),r.dispatchEvent(new CustomEvent("sortenter",{detail:{origin:{elementIndex:N,index:z,container:P},destination:{container:r,itemsBeforeUpdate:F},item:Y,originalTarget:n}})),a(r,"dragleave",function(e){var t=e.relatedTarget||e.fromElement;e.currentTarget.contains(t)||(m.dropTargetContainerClass&&r.classList.remove(m.dropTargetContainerClass),r.dispatchEvent(new CustomEvent("sortleave",{detail:{origin:{elementIndex:N,index:z,container:r},item:Y,originalTarget:n}})))})),j=r}),a(i,"dragend",function(e){var t;Y&&(Y.classList.remove(m.draggingClass),s(Y,"aria-grabbed","false"),"true"===Y.getAttribute("aria-copied")&&"true"!==l(Y,"dropped")&&Y.remove(),Y.style.display=Y.oldDisplay,delete Y.oldDisplay,(t=Array.from(h.values()).map(function(e){return e.placeholder}).filter(function(e){return e instanceof HTMLElement}).filter(f)[0])&&t.remove(),i.dispatchEvent(new CustomEvent("sortstop",{detail:{origin:{elementIndex:N,index:z,container:P},item:Y}})),O=_=Y=j=null)}),a(i,"drop",function(e){var t,n,r,o,a;M(i,Y.parentElement)&&(e.preventDefault(),e.stopPropagation(),l(Y,"dropped","true"),a=Array.from(h.values()).map(function(e){return e.placeholder}).filter(function(e){return e instanceof HTMLElement}).filter(f)[0],b(a,Y),a.remove(),i.dispatchEvent(new CustomEvent("sortstop",{detail:{origin:{elementIndex:N,index:z,container:P},item:Y}})),t=v(i).placeholder,n=g(P.children,m.items).filter(function(e){return e!==t}),r=!0===this.isSortable?this:this.parentElement,o=g(r.children,l(r,"items")).filter(function(e){return e!==t}),e=E(Y,Array.from(Y.parentElement.children).filter(function(e){return e!==t})),a=E(Y,o),m.dropTargetContainerClass&&r.classList.remove(m.dropTargetContainerClass),N===e&&P===r||i.dispatchEvent(new CustomEvent("sortupdate",{detail:{origin:{elementIndex:N,index:z,container:P,itemsBeforeUpdate:W,items:n},destination:{index:a,elementIndex:e,container:r,itemsBeforeUpdate:F,items:o},item:Y}})))});var o=d(function(t,e,n,r){if(Y)if(m.forcePlaceholderSize&&(v(t).placeholder.style.height=_+"px",v(t).placeholder.style.width=O+"px"),-1<Array.from(t.children).indexOf(e)){var o=T(e),a=C(e),i=E(v(t).placeholder,e.parentElement.children),l=E(e,e.parentElement.children);if(_<o||O<a){var s=o-_,c=a-O,d=y(e).top,f=y(e).left;if(i<l&&("vertical"===m.orientation&&r<d||"horizontal"===m.orientation&&n<f))return;if(l<i&&("vertical"===m.orientation&&d+o-s<r||"horizontal"===m.orientation&&f+a-c<n))return}void 0===Y.oldDisplay&&(Y.oldDisplay=Y.style.display),"none"!==Y.style.display&&(Y.style.display="none");c=!1;try{var u=y(e).top+e.offsetHeight/2,p=y(e).left+e.offsetWidth/2,c="vertical"===m.orientation&&u<=r||"horizontal"===m.orientation&&p<=n}catch(e){c=i<l}(c?b:w)(e,v(t).placeholder),Array.from(h.values()).filter(function(e){return void 0!==e.placeholder}).forEach(function(e){e.placeholder!==v(t).placeholder&&e.placeholder.remove()})}else{c=Array.from(h.values()).filter(function(e){return void 0!==e.placeholder}).map(function(e){return e.placeholder});-1!==c.indexOf(e)||t!==e||g(e.children,m.items).length||(c.forEach(function(e){return e.remove()}),e.appendChild(v(t).placeholder))}},m.debounce),t=function(e){var t,n=!0===(r=e.target).isSortable?r:R(r,e),r=X(n,r);Y&&M(n,Y.parentElement)&&"true"!==l(n,"_disabled")&&(t=l(n,"opts"),parseInt(t.maxItems)&&g(n.children,l(n,"items")).length>=parseInt(t.maxItems)&&Y.parentElement!==n||(e.preventDefault(),e.stopPropagation(),e.dataTransfer.dropEffect=!0===v(n).getConfig("copy")?"copy":"move",o(n,r,e.pageX,e.pageY)))};a(e.concat(i),"dragover",t),a(e.concat(i),"dragenter",t)}),e)}return U.destroy=function(e){var t,n;n=l(t=e,"opts")||{},e=g(t.children,n.items),n=i(e,n.handle),m(t,!1),o(t,"dragover"),o(t,"dragenter"),o(t,"dragstart"),o(t,"dragend"),o(t,"drop"),A(t),o(n,"mousedown"),H(e),S(e),I(P,j),t.isSortable=!1},U.enable=function(e){B(e)},U.disable=function(e){var t,n;n=l(t=e,"opts"),e=g(t.children,n.items),n=i(e,n.handle),s(t,"aria-dropeffect","none"),l(t,"_disabled","true"),s(n,"draggable","false"),o(n,"mousedown"),m(t,!1)},U.__testing={data:l,removeItemEvents:H,removeItemData:S,removeSortableData:A,removeContainerEvents:I},U}();